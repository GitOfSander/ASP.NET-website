(function(n,t,i){function u(n,t){var i=null;return function(){var r=this,u=arguments;clearTimeout(i);i=setTimeout(function(){n.apply(r,u)},t)}}function r(n){this.el=n;this.$el=i(n);this.animationFrame=null;this.scrolling=!1;this.currentTransforms=[];this.firstTops=[];this.speeds=[];this._setup();this._events()}function f(n){var f=Array.prototype.slice.call(arguments,1),u=i(this),t=u.data("parallax");t||u.data("parallax",t=new r(this,n));typeof n=="string"&&t[n]&&n[0]!=="_"&&t[n].apply(t,f)}(function(){for(var r=0,i=["ms","moz","webkit","o"],n=0;n<i.length&&!t.requestAnimationFrame;++n)t.requestAnimationFrame=t[i[n]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[i[n]+"CancelAnimationFrame"]||t[i[n]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(n){var i=(new Date).getTime(),u=Math.max(0,16-(i-r)),f=t.setTimeout(function(){n(i+u)},u);return r=i+u,f});t.cancelAnimationFrame||(t.cancelAnimationFrame=function(n){clearTimeout(n)})})();Function.prototype.bind||(Function.prototype.bind=function(n){var t=this;return function(){return t.apply(n,arguments)}});r.prototype._setup=function(){this.$window=i(t);this.lastScrollTop=null;this._cacheValues();this._parallax()};r.prototype._events=function(){this.$window.on("scroll.parallax.begin",this._beginScroll.bind(this));this.$window.on("scroll.parallax.debounce",u(function(){cancelAnimationFrame(this.animationFrame);this.scrolling=!1;this.$window.on("scroll.parallax.begin",this._beginScroll.bind(this))}.bind(this),250));this.$window.on("resize.parallax",u(this.refresh.bind(this),250))};r.prototype._beginScroll=function(){this.scrolling||(this._go(),this.scrolling=!0,this.$window.off("scroll.parallax.begin"))};r.prototype._cacheValues=function(){var n=this;this.$el.each(function(t){var r=i(this),u=n.currentTransforms[t],f=r.offset().top,e=u!==undefined?f-u:f;n.firstTops[t]=e;n.speeds[t]=r.attr("data-speed")})};r.prototype._go=function(){this.animationFrame=requestAnimationFrame(this._go.bind(this));this._parallax()};r.prototype._isInView=function(n){var i=n.getBoundingClientRect();return i.top<t.innerHeight&&i.bottom>0};r.prototype._parallax=function(){var t=this.$window.scrollTop(),n,u,r,f;if(t===this.lastScrollTop)return!1;for(this.lastScrollTop=t,n=0,u=this.$el.length;n<u;n++)(r=this.$el[n],this._isInView(r))&&(f=i(r),this.currentTransforms[n]=(t-this.firstTops[n])*this.speeds[n],f.css("transform","translate3d(0, "+this.currentTransforms[n]+"px,0)"))};r.prototype.refresh=function(){this.lastScrollTop=null;this._cacheValues();this._parallax()};i.fn.jQueryParallax=f})(document,window,jQuery);